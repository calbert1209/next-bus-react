(this["webpackJsonpnext-bus-react"]=this["webpackJsonpnext-bus-react"]||[]).push([[0],{10:function(t,e,n){},12:function(t,e,n){"use strict";n.r(e);var c=n(1),a=n.n(c),s=n(4),r=n.n(s),o=(n(9),n(2)),i=(n(10),n(0)),u=function(){var t=Object(c.useRef)(-1),e=Object(c.useState)(["--","--"]),n=Object(o.a)(e,2),a=n[0],s=n[1];return Object(c.useEffect)((function(){return t.current=window.setInterval((function(){var t=new Date,e=Intl.DateTimeFormat("ja-JP",{hour:"2-digit",minute:"2-digit"}).format(t).split(":"),n=Object(o.a)(e,2),c=n[0],a=n[1];s([c,a])}),500),function(){window.clearInterval(t.current)}}),[]),Object(i.jsxs)("div",{className:"currentTime",children:[Object(i.jsx)("span",{children:a[0]}),Object(i.jsx)("span",{className:"currentTimeColon",children:":"}),Object(i.jsx)("span",{children:a[1]})]})},d=function(t,e){return t.index-e.index},l=function(t){var e=t.headerData,n=e.busStop,c=e.dest,a=t.swapDirection,s=t.swapRoute;return Object(i.jsxs)("div",{className:"header centerAlignedColumn",children:[Object(i.jsx)("div",{className:"stopNameLabel",role:"button",onClick:s,children:n}),Object(i.jsxs)("div",{className:"destinationDisplay",children:[Object(i.jsx)("div",{className:"destinationLabel",children:c}),Object(i.jsx)(f,{rotate:!0,colored:!0,onClick:a})]}),Object(i.jsx)(u,{})]})},j=function(t){var e=t.stopTimes,n=t.index,c=e.filter((function(t){return t.index>=n})).sort(d).slice(0,4);return c.length<1&&console.warn("no times found"),Object(i.jsx)("div",{className:"stopTimeList",children:c.map((function(t,e){return Object(i.jsxs)("div",{className:"stopTimeRow","data-row":e,style:{fontSize:"".concat(4-e,"em")},children:[Object(i.jsx)("div",{className:"hour",children:t.hour}),Object(i.jsx)("div",{className:"colon",children:Object(i.jsx)("div",{children:":"})}),Object(i.jsx)("div",{className:"minute",children:(n=t.minute,"".concat(n<10?"0":"").concat(n))}),t.note&&Object(i.jsx)("div",{className:"stopTimeNote",children:Object(i.jsx)("div",{children:"(".concat(t.note,")")})})]},"".concat(t.index,"-").concat(t.note));var n}))})},f=function(t){var e=t.rotate,n=void 0!==e&&e,c=t.colored,a=void 0!==c&&c,s=t.onClick,r=["swapIcon"];n&&r.push("rotate90"),a&&r.push("coloredArrow");var o=r.join(" ");return Object(i.jsxs)("div",{className:o,role:"button",onClick:s,children:[Object(i.jsx)("div",{className:"swapArrow top",children:"\u2192"}),Object(i.jsx)("div",{className:"swapArrow bottom",children:"\u2190"})]})};function b(t,e){return{start:t,end:e,search:"?start=".concat(t,"&end=").concat(e)}}function h(t){var e,n,c,a=new URL(t).searchParams;return b(null!==(e=a.get("start"))&&void 0!==e?e:"kanai",null!==(n=null!==(c=a.get("end"))&&void 0!==c?c:a.get("dest"))&&void 0!==n?n:"totsuka")}var m=function(){var t=window.document.location.href,e=Object(c.useState)(!1),n=Object(o.a)(e,2),a=n[0],s=n[1],r=Object(c.useState)(null),u=Object(o.a)(r,2),d=u[0],f=u[1],m=Object(c.useState)((function(){return h(t)})),v=Object(o.a)(m,2),O=v[0],x=v[1],p=Object(c.useState)(function(){var t=new Date;return 60*t.getHours()+t.getMinutes()}()),w=Object(o.a)(p,2),g=w[0];w[1],Object(c.useEffect)((function(){x(h(t))}),[t]),Object(c.useEffect)((function(){var t=O.search;window.location.search!==t&&(window.location.search=t)}),[O]),Object(c.useEffect)((function(){if(!a){var t=h(document.location.href);x(t);var e=function(t,e){var n=t.start,c=t.end,a="?start=".concat(n,"&end=").concat(c,"&index=").concat(e);return"https://script.google.com/macros/s/".concat("AKfycbw3IFf_lsQCWbp6a5ckSYKPWXdLKdCThBU2xytDqjrfX7JJId3_BqALBnDZ_3MWaGBrDQ","/exec").concat(a)}(t,g);window.fetch(e).then((function(t){return t.text()})).then(JSON.parse).then((function(t){return{header:t.header,times:t.times}})).then((function(t){s(!0),f(t)}))}}),[a,g]);var N=O.start,k=O.end,D="ofuna"===N||"ofuna"===k?"ofuna":"totsuka";return Object(i.jsxs)("div",{className:"App","data-dest":D,children:[Object(i.jsxs)("div",{className:"stopTimeReport",children:[!a&&Object(i.jsx)("div",{className:"loading",children:"loading..."}),d&&Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)(l,{headerData:d.header,swapDirection:function(){x((function(t){return b(t.end,t.start)}))},swapRoute:function(){x((function(t){if("ofuna"===t.start)return b("totsuka",t.end);if("totsuka"===t.start)return b("ofuna",t.end);var e="ofuna"===t.end?"totsuka":"ofuna";return b(t.start,e)}))}}),Object(i.jsx)(j,{stopTimes:d.times,index:g})]})]}),Object(i.jsx)("div",{id:"modalMountPoint"})]})},v=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,13)).then((function(e){var n=e.getCLS,c=e.getFID,a=e.getFCP,s=e.getLCP,r=e.getTTFB;n(t),c(t),a(t),s(t),r(t)}))},O=.01*(window.innerHeight+20);document.documentElement.style.setProperty("--vh","".concat(O,"px")),r.a.render(Object(i.jsx)(a.a.StrictMode,{children:Object(i.jsx)(m,{})}),document.getElementById("root")),v()},9:function(t,e,n){}},[[12,1,2]]]);
//# sourceMappingURL=main.5be19770.chunk.js.map